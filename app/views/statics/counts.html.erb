<% @studies.each do |study| %>
<h1>Study ID : <%= study[:id] %></h1>
<table>
	<thead>
		<tr>
			<th rowspan='3'>Racial Categories</th>
			<th colspan='9'>Ethnic Categories</th>
			<th rowspan='3'>Total</th>
		</tr>
		<tr>
			<th colspan='3'>Not Hispanic or Latino</th>
			<th colspan='3'>Hispanic or Latino</th>
			<th colspan='3'>Unknown / Not Reported Ethnicity</th>
		</tr>
		<tr>
			<th>Female</th>
			<th>Male</th>
			<th>Unknown / Not Reported</th>
			<th>Female</th>
			<th>Male</th>
			<th>Unknown / Not Reported</th>
			<th>Female</th>
			<th>Male</th>
			<th>Unknown / Not Reported</th>
		</tr>
	</thead>
	<tbody>
	<% study[:races].each do |race| %>
		<tr>
			<td><%= race %></td>
			<% race_d = study[:demographics].select{|v|v[:race].length==1 && v[:race][0] == race} %>

			<% race_d_h = race_d.select{|v| v[:hispanic][0] == "No" } %>
			<td><%= race_d_h_s = race_d_h.select{|v| v[:gender][0] == "Female/Femenino" }.length %></td>
			<td><%= race_d_h_s = race_d_h.select{|v| v[:gender][0] == "Male/Masculino" }.length %></td>
			<td><%= race_d_h_s = race_d_h.select{|v| v[:gender][0].blank? || v[:gender][0] == "Other/Otro" }.length %></td>

			<% race_d_h = race_d.select{|v| v[:hispanic][0] == "Yes/SÃ­" } %>
			<td><%= race_d_h_s = race_d_h.select{|v| v[:gender][0] == "Female/Femenino" }.length %></td>
			<td><%= race_d_h_s = race_d_h.select{|v| v[:gender][0] == "Male/Masculino" }.length %></td>
			<td><%= race_d_h_s = race_d_h.select{|v| v[:gender][0].blank? || v[:gender][0] == "Other/Otro" }.length %></td>

			<% race_d_h = race_d.select{|v| v[:hispanic].blank? || v[:hispanic][0].blank? } %>
			<td><%= race_d_h_s = race_d_h.select{|v| v[:gender][0] == "Female/Femenino" }.length %></td>
			<td><%= race_d_h_s = race_d_h.select{|v| v[:gender][0] == "Male/Masculino" }.length %></td>
			<td><%= race_d_h_s = race_d_h.select{|v| v[:gender][0].blank? || v[:gender][0] == "Other/Otro" }.length %></td>

			<td><%= race_d.length %></td>
		</tr>
	<% end %>
	</tbody>
</table>
<% end %>
